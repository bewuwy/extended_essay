\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper, margin=1in]{geometry}
% \usepackage{pgfplots}
\usepackage{array}
\usepackage{float}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{parskip}

\newcommand{\Hquad}{\hspace{0.5em}} 

\usepackage{url}
\usepackage[colorlinks,allcolors=black]{hyperref}

\usepackage{setspace}
\onehalfspacing

\setlength{\jot}{12pt} % vertical skips in equations

\title{Exploring mathematics of rolling bridges \\
    \large Extended essay \\
    \vspace{12pt} Word count: 1418}

\date{}
\author{}

\begin{document}

    \maketitle
    \newpage
    \tableofcontents
    \newpage
    
    \section{Research question}

    How can catenary curves be used in construction of non-circular ``rolling'' bridges?
    
    \section{Introduction}
    
        \begin{enumerate}
            \item My personal interest - I am interested in architecture and urban planning and this topic combines this with my passion for mathematics
            \item I have found this bridge in an internet video - as an interesting mathematical phenomena existing in real life
        \end{enumerate}

        \begin{figure}[H]
            \centering
            \includegraphics[width=0.75\linewidth]{images/bridge.png}
            \caption{Bridge photo \\\url{https://newatlas.com/architecture/cody-dock-rolling-bridge/}}
            \label{fig:bridge_photo}
        \end{figure}

    \section{References}

        \begin{enumerate}
            \item \url{https://community.wolfram.com/groups/-/m/t/2917199}
            \item \url{https://youtu.be/SsGEcLwjgEg}
            \item \url{https://youtu.be/xGxSTzaID3k}
        \end{enumerate}

    \newpage

    \section{Work plan}

        \begin{enumerate}
            \item square bridge \begin{enumerate}
                \item simple rolling square \begin{enumerate}
                    \item finding polar form - straight line times 4
                    \item finding relation between road and "wheel"
                    \item get y(t), then find road equation in y(x) form
                    \item catenary road = -cosh x
                \end{enumerate}
                \item rounded square \begin{enumerate}
                    \item why rounded - gears teeth
                    \item why rounded corners are hard - rolling on a circle, but centre of mass is outside of it
                    \item calculating road for the rounded square \begin{enumerate}
                        \item polar form of a rounded corner
                        \item symbolic solution \begin{itemize}
                            \item definite integration
                            \item elliptic integral of 2nd kind
                            \item cant get y(x)
                        \end{itemize}
                        \item numerical solution
                    \end{enumerate}
                    \item setting centre of mass to be at geometric centre (adding additional weight at the top of the bridge)
                    \item find location of gear teeth - roll the track around and trace intersection with bridge - inverse transformation of track around the bridge
                    \item calculating work needed to be done to roll the bridge - the centre of mass is actually 2inches below the geometric centre
                \end{enumerate}
            \end{enumerate}
            \item triangle bridge \begin{enumerate}
                \item normally cannot - too steep road and triangle crashes, but with rounded corners its possible
                \item the catenary curve is steeper, so more friction is needed
            \end{enumerate}
            \item polygonal bridge \begin{enumerate}
                \item pentagon and hexagon
            \end{enumerate}
            \item conclusion
        \end{enumerate}

    \section{``Smoothly'' rolling square}

        In order to start, the ``smooth rolling'' has to be defined. If we e.g.\ take a circle shape and roll it on a straight surface, then it will roll ``smoothly''~-~its center of mass will move only horizontally and not vertically. However, when a square is rolled on the same surface, its center of mass will move vertically as well and hence its movement will not be ``smooth''.

        Even so, why is it important to roll ``smoothly''? The answer is connected to physics, more specifically to the work needed to be done to roll the shape. If the figure is rolled ``smoothly'', then there is no need to do work in moving the center of mass up and down. Therefore, in the ideal world, the shape will roll without any work needed to be done (in reality, there is always some friction, so some work will always be needed to be done).

        Another important property for this ``rolling'' is that when any point of the shape is in contact with the road surface, its velocity relative to it has to be zero. Otherwise, if the point was moving while touching the road, it would be sliding and not rolling.

        However, there must exist a surface (other than straight road) on which a square can roll ``smoothly''. It will be described parametrically as follows:
        \begin{align}
            \begin{cases}
            x = x(t) \\
            y = y(t)
            \end{cases}
        \end{align}

        Similarly, the square shape will also be parametrized. However, it will be parametrized in polar coordinates, as this representation will be easier to work with. The parametrization is as follows: 
        \begin{align}
            \begin{cases}
            r = r(t) \\
            \theta = \theta(t)
            \end{cases}
        \end{align}

        To simplify the calculations, the line of movement of the center of mass of the square will be chosen to be the x-axis. Hence, the road will have to be under it, so $y(t) < 0$. Likewise, the center of mass of the square point (axle) will be chosen to be at the origin of its local coordinate system. The parameter $t$ can be thought of as the time, at which there is a point on the square and on the road, which are touching. Therefore, the point $(x, y)$ on the road will be the contact point on the road curve and similarly the point $(r, \theta)$ will be the contact point on the square curve.

        Now, the relations between those two curves need to be found. If it is assumed that the square is on the road, then it must be touching it at some point. Moreover, the point of contact is not a random point on the curve, but the one directly beneath the center mass point (so the origin point). Therefore, it has to be the $r(t)$ point on the square curve. Hence, the distance from axle to the road must be equal to the road's depth ($-y(t)$):
        \begin{equation}
            r(t) = - y(t)
        \end{equation}

        Another relation can be found by looking at the contact point's velocity. It was earlier defined, that during contact, the velocity of a point relative to the road has to be zero. However, when it is looked at from the perspective of the axle point, all points on the square are constantly moving (while rolling). Therefore, if the point is stationary relative to the ground, but moving relative to the center point, then those speeds have to be equal to each other. The speed relative to road is simply $|\frac{dx}{dt}|$, while the speed relative to the axle can be calculated from its angular speed:
        \begin{flalign*}
            \omega &= \frac{d\theta}{dt} \\
            v &= r \cdot \omega \\
            v_{\text{axle}} &= r \frac{d\theta}{dt}
        \end{flalign*}

        Thence (the speeds, not the velocities are equal, hence the absolute value):
        \begin{align}
            \bigl|\frac{dx}{dt}\bigr| = \bigl|r \frac{d\theta}{dt}\bigr| \nonumber \\
            \frac{dx}{dt} = \pm\; r \frac{d\theta}{dt}
        \end{align}

        However, it can be assumed that the square will roll to the right (in the positive $x$ direction), so the contact point will have to rotate counter-clockwise. Therefore, both $\frac{dx}{dt}$ and $\frac{d\theta}{dt}$ have to be positive. Hence:
        \begin{equation}
            \frac{dx}{dt} = r \frac{d\theta}{dt}
        \end{equation}

        Therefore, there are two relations between the road and square curve:
        \begin{equation}
            \begin{cases}
                r = - y \\
                \frac{dx}{dt} = r \frac{d\theta}{dt}
            \end{cases}
        \end{equation}

        The $y$ part of the road curve can easily be found:
        \begin{align}
            % r(t) = - y(t) \nonumber \\
            y = -r
        \end{align}

        Hence:
        \begin{equation}\label{eq:road_1}
            \begin{cases}
                y = -r \\
                \frac{dx}{dt} = r \frac{d\theta}{dt}
            \end{cases}
        \end{equation}

        Now, the parametric functions for a square need to be found in order to find the road curve. For the simplicity of this calculation let the side length of the square be 2. To find the equations it is easiest to start with just a single side of the square (starting at $(1, -1)$ and ending at $(1, 1)$). Therefore, x stays constant and y varies from -1 to 1. The parametric equations are as follows:
        \begin{align}
            x(t) = 1 \\
            y(t) = t
        \end{align}

        Those formulas can be converted to polar form using the following equations\cite{polar_rectangular}:
        \begin{align}
            r &= \sqrt{x^2 + y^2} \\
            \theta &= \arctan\frac{y}{x}
        \end{align}

        Therefore:
        \begin{align}
            r(t) &= \sqrt{1^2 + t^2} = \sqrt{1+t^2} \\
            \theta(t) &= \arctan\frac{t}{1} = \arctan(t)
        \end{align}

        These equations may be used to substitute into Equation \ref{eq:road_1}, which is very easy for the $y$ part:
        \begin{align}
            y &= -r = -\sqrt{1+t^2}
            % \frac{dx}{dt} &= r \frac{d\theta}{dt}
        \end{align}

        For the $x$ part, the derivative of $\theta$ in respect to $t$ has to be found:
        \begin{align}
            \frac{d\theta}{dt} &= \frac{d}{dt} \arctan(t) \\
            &= \frac{1}{1+t^2}
        \end{align}

        Then it can be substituted into the equation:
        \begin{align}
            \frac{dx}{dt} &= r \frac{d\theta}{dt} \\
            \frac{dx}{dt} &= \sqrt{1+t^2} \frac{1}{1+t^2} \\
            \frac{dx}{dt} &= \frac{1}{\sqrt{1+t^2}}
        \end{align}

        To obtain $x(t)$, the integral of $\frac{dx}{dt}$ has to be found:
        \begin{align}
            \int \frac{dx}{dt} dt &= \int \frac{1}{\sqrt{1+t^2}} \;dt \\
            x(t) &= \int \frac{1}{\sqrt{1+t^2}} \;dt
        \end{align}

        Which is the integral of the derivative of inverse hyperbolic sine function\cite{oxford_dict}, therefore:
        \begin{align}
            x(t) &= \text{arsinh}(t) + c 
        \end{align}

        Hence, the road functions become ($c$ can be set to 0, as it is just a horizontal shift):
        \begin{equation}\label{eq:road_2}
            \begin{cases}
                x(t) = \text{arsinh}(t) \\
                y(t) = -\sqrt{1+t^2} \\
            \end{cases}
        \end{equation}

        They can be then turned back into cartesian form:
        \begin{align}
            t = \sinh(x) \\
            y = -\sqrt{1+\sinh^2(x)} \\ 
        \end{align}

        Using $\cosh^2(x) - \sinh^2(x) = 1$\cite{oxford_dict}, the equation can be simplified:
        \begin{align}
            y = -\sqrt{\cosh^2(x)} \\
            y(x) = -\cosh(x)
        \end{align}

        Which is actually an inverted catenary curve. This is a shape that is formed by a hanging chain, which is a very common shape in architecture. It can be seen graphed below:
        
        \begin{figure}[H]
            \centering
            \includegraphics[width=0.8\linewidth]{images/cosh_many.png}
            \caption{Catenary curve with 3 square sides ``rolling'' on top of it}\label{fig:cosh}
        \end{figure}

        It can be observed, that this shape is not the whole road, but only its fragment. It is due to the previous approximation of only one side. However, the road is periodical and needs to repeat every time the magnitude of its slope is equal to $1$\cite{Hall_Wagon_1992}. % TODO - maybe explain why

        Therefore it needs to be truncated when:
        \begin{equation}
            | \frac{dy}{dx} | = 1
        \end{equation}

        The derivative of $\cosh x$ is $\sinh x$, therefore:
        \begin{align*}
            \frac{dy}{dx} = - \sinh x \\
        % \end{align*}
        % \begin{align*}
            \Rightarrow | - \sinh x | = 1 \\
            \sinh x = 1 \quad\lor\quad \sinh x = -1
        \end{align*}

        Thus, the points at which to truncate are:
        \begin{align*}
            x = \text{arsinh}(1) \quad\lor\quad x = \text{arsinh}(-1)
        \end{align*}

        Due to arsinh properties $\text{arsinh}(-x) = - \text{arsinh}(x)$, so:
        \begin{equation}
            x = \pm \text{arsinh}(1)
        \end{equation} 

        It has been found that for any polygon of n-sides, if the road is truncated at $x = \pm \; \text{arsinh}(\tan(\pi / n))$, then the amount of rotation to get the polygon in the cusp is $\frac{2\pi}{n}$\cite{Hall_Wagon_1992}. This statement holds true, as for square $n=4$ and $\tan(\frac{\pi}{4}) = 1$. Therefore, the cusp angle is $\frac{\pi}{2}$ rad, the road fragments will intersect at a right angle, which makes sense given that a square's vertex needs to fit in between them. Thus, next road fragments should have the equation\cite{Hall_Wagon_1992}:
        \begin{equation}
            y = - \cosh (x + 2k \;\text{arsinh}(1) ) \quad \text{where}\; k \in \mathbb{Z}
        \end{equation}
        
        A 3-fragment road can be seen below:
        \begin{figure}[H]
            \centering
            \includegraphics[width=\linewidth]{images/road_3.png}
            \caption{Road for a rolling square consisting of 3 fragments}\label{fig:road3}
        \end{figure}

    \section{Rounding the square}

        However, the bridge cannot be a polygon with sharp corners, as standing on just one point (vertex of the square) would be too unstable for such a big structure (it weights 13 tons\cite{bridge_newatlas}). Therefore, the corners of the square have to be rounded. This can be done by adding a circle of radius $b$ to each corner of the square. (In the actual bridge the radius is equal to $0.25$ when the side length of the square is set to $2$). The new shape can be seen on Figure~\ref{fig:rounded_square} below.

        \begin{figure}[H]
            \centering
            \includegraphics[width=0.9\linewidth]{images/rounded_square.png}
            \caption{Rounded square\cite{bridge_wolfram}}\label{fig:rounded_square}
        \end{figure}

        % TODO derive polar form of the corner

        The corners have the polar form\cite{bridge_wolfram} [Here maybe also add derivation?]:
        \begin{equation}
            r = (1-b)\sqrt{2} \cos (\frac{\pi}{4} + \theta) + \sqrt{b^2 - 2(1-b)^2 \sin^2 (\frac{\pi}{4}+\theta)}
        \end{equation}
        \[- \text{arccot}(1-b) \leq \theta \leq \text{arccot}(1-b) - \frac{\pi}{2}\]

        Substituting $b=0.25$, the polar form of the rounded square is found:
        \begin{equation}
            r(\theta) = \frac{3\sqrt{2}}{4} \cos (\frac{\pi}{4} + \theta) + \sqrt{\frac{1}{16} - \frac{9}{8} \sin^2 (\frac{\pi}{4}+\theta)}
        \end{equation}
        \[- \text{arccot}(\frac{3}{4}) \leq \theta \leq \text{arccot}(\frac{3}{4}) - \frac{\pi}{2} \quad \approx \quad -0.927 \leq \theta \leq -0.644\]

        Now, the road for the corners has to be found. From Equation~\ref{eq:road_1} it is easy to find $y$:
        \begin{equation}
            y(\theta) = - \frac{3\sqrt{2}}{4} \cos (\frac{\pi}{4} + \theta) - \sqrt{\frac{1}{16} - \frac{9}{8} \sin^2 (\frac{\pi}{4}+\theta)}
        \end{equation}

        This way, we find $y$ in terms of the angle $\theta$, but this form will be easier for this part of the road. Hence, $x$ should also be found in terms of $\theta$.
        % \begin{align*}
        %     x = x(t) = x(t(\theta))
        % \end{align*}

        % Thus, by chain rule:
        % \begin{align*}
        %     \frac{dx}{d\theta} = \frac{d}{d\theta} \Bigr(x(t(\theta))\Bigl) = \frac{dx}{dt} \cdot \frac{dt}{d\theta}
        % \end{align*}

        From Equation~\ref{eq:road_1} it is known that:
        \begin{equation}
            \frac{dx}{dt} = r \frac{d\theta}{dt}
        \end{equation}

        Thus:
        \begin{align}
            \int \frac{dx}{dt} \Hquad dt &= \int r \frac{d\theta}{dt} \Hquad dt \\
            \int dx &= \int r d\theta \\
            x &= \int r d\theta
        \end{align}

        Substituting $r$:
        \begin{align}
            x(\theta) &= \int \frac{3\sqrt{2}}{4} \cos (\frac{\pi}{4} + \theta) + \sqrt{\frac{1}{16} - \frac{9}{8} \sin^2 (\frac{\pi}{4}+\theta)} \Hquad d\theta \\
            &= \frac{3\sqrt{2}}{4} \int \cos (\frac{\pi}{4} + \theta) \Hquad d\theta + \int \sqrt{\frac{1}{16} - \frac{9}{8} \sin^2 (\frac{\pi}{4}+\theta)} \Hquad d\theta
        \end{align}

        Let:
        \begin{align*}
            I_1 = \frac{3\sqrt{2}}{4} \int \cos (\frac{\pi}{4} + \theta) \Hquad d\theta \quad \text{,} \quad
            I_2 = \int \sqrt{\frac{1}{16} - \frac{9}{8} \sin^2 (\frac{\pi}{4}+\theta)} \Hquad d\theta
        \end{align*}

        Using compound angle identity:
        \begin{align}
            I_1 &= \frac{3\sqrt{2}}{4} \int \cos (\frac{\pi}{4}) \cos(\theta) - \sin(\frac{\pi}{4}) \sin(\theta) \Hquad d\theta \\
            &= \frac{3\sqrt{2}}{4} \int \frac{1}{\sqrt{2}} \cos(\theta) - \frac{1}{\sqrt{2}} \sin(\theta) \Hquad d\theta \\
            &= \frac{3\sqrt{2}}{4} \cdot \frac{1}{\sqrt{2}} \int \cos(\theta) - \sin(\theta) \Hquad d\theta \\
            I_1 &= \frac{3}{4} \cdot \frac{\sin(\theta) + \cos(\theta)}{\sqrt{2}}
        \end{align}

        However, the $I_2$ integral is way trickier than the $I_1$ one and cannot be solved using simple methods learned during the IB mathematics, as it is an elliptic integral of the second kind\cite{elliptic_integral}. Therefore, it will be instead solved numerically using the Euler's method. 

        Euler's method states that:
        \begin{align*}
            y_{n+1} = y_n + h \cdot f(x_n, y_n) \\
            x_{n+1} = x_n +h
        \end{align*}
 
        \begin{equation}
            x = \frac{3}{4} \cdot \frac{\sin(\theta) + \cos(\theta)}{\sqrt{2}} + \int \sqrt{\frac{1}{16} - \frac{9}{8} \sin^2 (\frac{\pi}{4}+\theta)} \Hquad d\theta
        \end{equation}

    % bibliography
    \newpage
    \bibliographystyle{unsrt}
    \bibliography{refs}

    % \section{Conclusion}
    
    %     \subsection{Reflections}    
    
    %     \subsection{Limitations}
    
    %         How to improve, etc.
        
\end{document}
